From cf23579418d5b14dc0e140008c3ad65388f6e8de Mon Sep 17 00:00:00 2001
From: "Adam D. Ruppe" <destructionator@gmail.com>
Date: Fri, 15 Dec 2023 12:32:07 -0500
Subject: [PATCH] fix null dereference segfault

---
 xkb/xkbActions.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/xkb/xkbActions.c b/xkb/xkbActions.c
index 5e9a6b6d6e..f56a191f1c 100644
--- a/xkb/xkbActions.c
+++ b/xkb/xkbActions.c
@@ -1225,6 +1225,9 @@ XkbPushLockedStateToSlaves(DeviceIntPtr master, int evtype, int key)
     DeviceIntPtr dev;
     Bool genStateNotify;
 
+    if (!master)
+        return;
+
     nt_list_for_each_entry(dev, inputInfo.devices, next) {
         if (!dev->key || GetMaster(dev, MASTER_KEYBOARD) != master)
             continue;
-- 
GitLab

