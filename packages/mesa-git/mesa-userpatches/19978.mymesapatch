From 6b635978352344c846084e4ef066d952edd12c2b Mon Sep 17 00:00:00 2001
From: Yonggang Luo <luoyonggang@gmail.com>
Date: Thu, 24 Nov 2022 18:50:26 +0800
Subject: [PATCH] util: Use assembly for util_iround on X86_64

Signed-off-by: Yonggang Luo <luoyonggang@gmail.com>
---
 src/util/u_math.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/util/u_math.h b/src/util/u_math.h
index 2a78e7811803..fdbe593f5370 100644
--- a/src/util/u_math.h
+++ b/src/util/u_math.h
@@ -159,7 +159,7 @@ util_ifloor(float f)
 static inline int
 util_iround(float f)
 {
-#if DETECT_CC_GCC && DETECT_ARCH_X86
+#if DETECT_CC_GCC && (DETECT_ARCH_X86 || DETECT_ARCH_X86_64)
    int r;
    __asm__ ("fistpl %0" : "=m" (r) : "t" (f) : "st");
    return r;
-- 
GitLab

