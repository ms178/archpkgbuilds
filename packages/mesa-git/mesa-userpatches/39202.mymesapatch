diff --git a/src/compiler/nir/nir_search_helpers.h b/src/compiler/nir/nir_search_helpers.h
index f73ac1a0c6916..3845a0443dc7f 100644
--- a/src/compiler/nir/nir_search_helpers.h
+++ b/src/compiler/nir/nir_search_helpers.h
@@ -1036,4 +1036,33 @@ w_is_zero(const nir_search_state *state, const nir_alu_instr *instr, unsigned sr
    return compare_component(instr, src, swizzle[3], 0.0);
 }
 
+static inline bool
+can_add_output_modifier(const nir_search_state *state,
+                        const nir_alu_instr *instr,
+                        unsigned src,
+                        UNUSED unsigned num_components,
+                        UNUSED const uint8_t *swizzle)
+{
+   nir_alu_instr *src_alu = nir_src_as_alu(instr->src[src].src);
+
+   if (src_alu == NULL)
+      return false;
+
+   if (!list_is_singular(&src_alu->def.uses))
+      return false;
+
+   nir_alu_type output_type = nir_op_infos[src_alu->op].output_type;
+   return nir_alu_type_get_base_type(output_type) == nir_type_float;
+}
+
+static inline bool
+cannot_add_output_modifier(const nir_search_state *state,
+                           const nir_alu_instr *instr,
+                           unsigned src,
+                           unsigned num_components,
+                           const uint8_t *swizzle)
+{
+   return !can_add_output_modifier(state, instr, src, num_components, swizzle);
+}
+
 #endif /* _NIR_SEARCH_ */
-- 
GitLab

