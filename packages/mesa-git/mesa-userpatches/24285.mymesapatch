From 126c73f2e77d0e87709d3d857de7325713d87c24 Mon Sep 17 00:00:00 2001
From: Mike Blumenkrantz <michael.blumenkrantz@gmail.com>
Date: Fri, 21 Jul 2023 12:48:19 -0400
Subject: [PATCH 1/3] radv: bump max xfb output to 128

this is the number of components supported for streamout
---
 src/amd/compiler/aco_shader_info.h | 2 +-
 src/amd/vulkan/radv_constants.h    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/amd/compiler/aco_shader_info.h b/src/amd/compiler/aco_shader_info.h
index 9bba7697f8bab..715ae08b39036 100644
--- a/src/amd/compiler/aco_shader_info.h
+++ b/src/amd/compiler/aco_shader_info.h
@@ -36,7 +36,7 @@
 extern "C" {
 #endif
 
-#define ACO_MAX_SO_OUTPUTS     64
+#define ACO_MAX_SO_OUTPUTS     128
 #define ACO_MAX_SO_BUFFERS     4
 #define ACO_MAX_VERTEX_ATTRIBS 32
 #define ACO_MAX_VBS            32
diff --git a/src/amd/vulkan/radv_constants.h b/src/amd/vulkan/radv_constants.h
index 868e6c3b7bd15..81d8321b92fac 100644
--- a/src/amd/vulkan/radv_constants.h
+++ b/src/amd/vulkan/radv_constants.h
@@ -48,7 +48,7 @@
 #define MAX_VIEWS                      8
 #define MAX_SO_STREAMS                 4
 #define MAX_SO_BUFFERS                 4
-#define MAX_SO_OUTPUTS                 64
+#define MAX_SO_OUTPUTS                 128
 #define MAX_INLINE_UNIFORM_BLOCK_SIZE  (4ull * 1024 * 1024)
 #define MAX_INLINE_UNIFORM_BLOCK_COUNT 64
 #define MAX_BIND_POINTS                3 /* compute + graphics + raytracing */
-- 
GitLab


From 3f9d87443f502b84a278a3d7691339660d98f004 Mon Sep 17 00:00:00 2001
From: Mike Blumenkrantz <michael.blumenkrantz@gmail.com>
Date: Fri, 21 Jul 2023 12:48:19 -0400
Subject: [PATCH 2/3] ir3: bump max xfb output to 128

this is the number of components supported for streamout
---
 src/freedreno/ir3/ir3_shader.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/freedreno/ir3/ir3_shader.h b/src/freedreno/ir3/ir3_shader.h
index f852e581abb7f..4aa1422033b37 100644
--- a/src/freedreno/ir3/ir3_shader.h
+++ b/src/freedreno/ir3/ir3_shader.h
@@ -98,7 +98,7 @@ enum ir3_driver_param {
 #define IR3_MAX_SHADER_IMAGES   32
 #define IR3_MAX_SO_BUFFERS      4
 #define IR3_MAX_SO_STREAMS      4
-#define IR3_MAX_SO_OUTPUTS      64
+#define IR3_MAX_SO_OUTPUTS      128
 #define IR3_MAX_UBO_PUSH_RANGES 32
 
 /* mirrors SYSTEM_VALUE_BARYCENTRIC_ but starting from 0 */
-- 
GitLab


From c1a0d2c6a76ee3841abfdf924969892d5e26a60f Mon Sep 17 00:00:00 2001
From: Mike Blumenkrantz <michael.blumenkrantz@gmail.com>
Date: Fri, 21 Jul 2023 12:48:19 -0400
Subject: [PATCH 3/3] gallium: bump PIPE_MAX_SO_OUTPUTS to 128

this is the number of components supported for streamout
---
 src/gallium/include/pipe/p_state.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/gallium/include/pipe/p_state.h b/src/gallium/include/pipe/p_state.h
index 549e4d21c05de..e1953e1af8344 100644
--- a/src/gallium/include/pipe/p_state.h
+++ b/src/gallium/include/pipe/p_state.h
@@ -70,7 +70,7 @@ extern "C" {
 #define PIPE_MAX_SHADER_IMAGES    64
 #define PIPE_MAX_TEXTURE_LEVELS   16
 #define PIPE_MAX_SO_BUFFERS        4
-#define PIPE_MAX_SO_OUTPUTS       64
+#define PIPE_MAX_SO_OUTPUTS       128
 #define PIPE_MAX_VIEWPORTS        16
 #define PIPE_MAX_CLIP_OR_CULL_DISTANCE_COUNT 8
 #define PIPE_MAX_CLIP_OR_CULL_DISTANCE_ELEMENT_COUNT 2
-- 
GitLab

