From fe3933baaa1c1f73bd23737a9ce54e6cc55e32ba Mon Sep 17 00:00:00 2001
From: Yiwei Zhang <zzyiwei@chromium.org>
Date: Sat, 9 Dec 2023 08:53:09 +0000
Subject: [PATCH] vulkan/wsi/x11: properly treat
 XCB_PRESENT_COMPLETE_MODE_SUBOPTIMAL_COPY

Signed-off-by: Yiwei Zhang <zzyiwei@chromium.org>
---
 src/vulkan/wsi/wsi_common_x11.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/vulkan/wsi/wsi_common_x11.c b/src/vulkan/wsi/wsi_common_x11.c
index 9cfdc6f968374..90f5013fa0460 100644
--- a/src/vulkan/wsi/wsi_common_x11.c
+++ b/src/vulkan/wsi/wsi_common_x11.c
@@ -1285,8 +1285,8 @@ x11_handle_dri3_present_event(struct x11_swapchain *chain,
          break;
 #ifdef HAVE_DRI3_MODIFIERS
       case XCB_PRESENT_COMPLETE_MODE_SUBOPTIMAL_COPY:
-         /* The winsys is now trying to flip directly and cannot due to our
-          * configuration. Request the user reallocate.
+         /* Xwayland or here to check format/modifier before returning
+          * suboptimal?
           */
          result = VK_SUBOPTIMAL_KHR;
          break;
-- 
GitLab

