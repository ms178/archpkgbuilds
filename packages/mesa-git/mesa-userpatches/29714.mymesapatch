From 2603c168c5d03b74a96d562f8f60d15202b1c365 Mon Sep 17 00:00:00 2001
From: Samuel Pitoiset <samuel.pitoiset@gmail.com>
Date: Thu, 13 Jun 2024 12:36:13 +0200
Subject: [PATCH] radv: allow VK_NV_device_generated_commands_{compute} with
 LLVM

DGC was disabled for LLVM due to 5/8 components SSBO stores but they
were not expected to work and this has been changed since a977a51a216
("radv: stop using 5/8 component SSBO stores"). No strong reason to
not enable it.

Signed-off-by: Samuel Pitoiset <samuel.pitoiset@gmail.com>
---
 src/amd/vulkan/radv_physical_device.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/amd/vulkan/radv_physical_device.c b/src/amd/vulkan/radv_physical_device.c
index d4708b93bcea7..bb872357e55ec 100644
--- a/src/amd/vulkan/radv_physical_device.c
+++ b/src/amd/vulkan/radv_physical_device.c
@@ -698,8 +698,8 @@ radv_physical_device_get_supported_extensions(const struct radv_physical_device
       .INTEL_shader_integer_functions2 = true,
       .MESA_image_alignment_control = pdev->info.gfx_level >= GFX9 && pdev->info.gfx_level <= GFX11_5,
       .NV_compute_shader_derivatives = true,
-      .NV_device_generated_commands = !pdev->use_llvm && instance->drirc.enable_dgc,
-      .NV_device_generated_commands_compute = !pdev->use_llvm && instance->drirc.enable_dgc,
+      .NV_device_generated_commands = instance->drirc.enable_dgc,
+      .NV_device_generated_commands_compute = instance->drirc.enable_dgc,
       /* Undocumented extension purely for vkd3d-proton. This check is to prevent anyone else from
        * using it.
        */
-- 
GitLab

