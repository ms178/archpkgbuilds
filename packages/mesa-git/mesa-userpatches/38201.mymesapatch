From 8cc6bf072216616c2af48e17d518853a40574140 Mon Sep 17 00:00:00 2001
From: stefan11111 <stefan11111@shitposting.expert>
Date: Sun, 2 Nov 2025 02:52:07 +0200
Subject: [PATCH] glx: Add some NULL pointer checks

Signed-off-by: stefan11111 <stefan11111@shitposting.expert>
---
 src/glx/glxcmds.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/glx/glxcmds.c b/src/glx/glxcmds.c
index 48ebfe126e9f0..f33af34a7a22a 100644
--- a/src/glx/glxcmds.c
+++ b/src/glx/glxcmds.c
@@ -157,7 +157,7 @@ GetGLXPrivScreenConfig(Display * dpy, int scrn, struct glx_display ** ppriv,
 
    /* Check to see if the GL is supported on this screen */
    *ppsc = (*ppriv)->screens[scrn];
-   if ((*ppsc)->configs == NULL && (*ppsc)->visuals == NULL) {
+   if (*ppsc == NULL || ((*ppsc)->configs == NULL && (*ppsc)->visuals == NULL)) {
       /* No support for GL on this screen regardless of visual */
       return GLX_BAD_VISUAL;
    }
@@ -1477,6 +1477,7 @@ glXGetFBConfigs(Display * dpy, int screen, int *nelements)
    *nelements = 0;
    if (priv && (priv->screens != NULL)
        && (screen >= 0) && (screen < ScreenCount(dpy))
+       && (priv->screens[screen] != NULL)
        && (priv->screens[screen]->configs != NULL)
        && (priv->screens[screen]->configs->fbconfigID
       != (int) GLX_DONT_CARE)) {
-- 
GitLab

