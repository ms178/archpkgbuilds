From 8692b36dbbe8f85f8cbae81eae982a061b4d80de Mon Sep 17 00:00:00 2001
From: Pierre-Eric Pelloux-Prayer <pierre-eric.pelloux-prayer@amd.com>
Date: Tue, 10 Jan 2023 10:01:06 +0100
Subject: [PATCH 1/2] mesa: add missing count_scale attribute

The EXT_gpu_program_parameters spec says:

   <params> points to an array of 4*<count> values

Fixes: a4e935f2d70 ("mesa: add EXT_dsa + EXT_gpu_program_parameters functions")
Closes: https://gitlab.freedesktop.org/mesa/mesa/-/issues/7943
Closes: https://gitlab.freedesktop.org/mesa/mesa/-/issues/8025
---
 src/mapi/glapi/gen/EXT_direct_state_access.xml | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/mapi/glapi/gen/EXT_direct_state_access.xml b/src/mapi/glapi/gen/EXT_direct_state_access.xml
index b7fc5283f8fb..a450846c215f 100644
--- a/src/mapi/glapi/gen/EXT_direct_state_access.xml
+++ b/src/mapi/glapi/gen/EXT_direct_state_access.xml
@@ -1400,8 +1400,8 @@
       <param name="program" type="GLuint" />
       <param name="target" type="GLenum" />
       <param name="index" type="GLuint" />
-      <param name="count" type="GLsizei" />
-      <param name="params" type="const GLfloat*" count="4"/>
+      <param name="count" type="GLsizei" counter="true"/>
+      <param name="params" type="const GLfloat*" count="count" count_scale="4"/>
    </function>
 
 </category>
-- 
GitLab


From 00eeed46485b20d272474cd289782bcfb246b6f8 Mon Sep 17 00:00:00 2001
From: Pierre-Eric Pelloux-Prayer <pierre-eric.pelloux-prayer@amd.com>
Date: Tue, 10 Jan 2023 10:04:40 +0100
Subject: [PATCH 2/2] mesa: add missing count_scale attributes

The EXT_gpu_program_parameters spec says:

   <params> points to an array of 4*<count> values

for both functions.

Cc: mesa-stable
---
 src/mapi/glapi/gen/gl_API.xml | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/src/mapi/glapi/gen/gl_API.xml b/src/mapi/glapi/gen/gl_API.xml
index c69539c88abf..03793d95f9fe 100644
--- a/src/mapi/glapi/gen/gl_API.xml
+++ b/src/mapi/glapi/gen/gl_API.xml
@@ -12760,15 +12760,15 @@
     <function name="ProgramEnvParameters4fvEXT" deprecated="3.1" exec="dlist">
         <param name="target" type="GLenum"/>
         <param name="index" type="GLuint"/>
-        <param name="count" type="GLsizei"/>
-        <param name="params" type="const GLfloat *" count="4"/>
+        <param name="count" type="GLsizei" counter="true"/>
+        <param name="params" type="const GLfloat *" count="count" count_scale="4"/>
     </function>
 
     <function name="ProgramLocalParameters4fvEXT" deprecated="3.1" exec="dlist">
         <param name="target" type="GLenum"/>
         <param name="index" type="GLuint"/>
-        <param name="count" type="GLsizei"/>
-        <param name="params" type="const GLfloat *" count="4"/>
+        <param name="count" type="GLsizei" counter="true"/>
+        <param name="params" type="const GLfloat *" count="count" count_scale="4"/>
     </function>
 </category>
 
-- 
GitLab

