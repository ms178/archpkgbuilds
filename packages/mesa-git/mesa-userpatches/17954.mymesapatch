From 07aae4393ef460e66c27b79844c128670fececdb Mon Sep 17 00:00:00 2001
From: Rhys Perry <pendingchaos02@gmail.com>
Date: Tue, 9 Aug 2022 11:42:10 +0100
Subject: [PATCH] aco: fix hash statistic

Signed-off-by: Rhys Perry <pendingchaos02@gmail.com>
Reviewed-by: Samuel Pitoiset <samuel.pitoiset@gmail.com>
Fixes: 897561b7b98 ("aco: add aco_postprocess_shader() helper")
---
 src/amd/compiler/aco_interface.cpp | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/amd/compiler/aco_interface.cpp b/src/amd/compiler/aco_interface.cpp
index f98a23753903..03544424c2e7 100644
--- a/src/amd/compiler/aco_interface.cpp
+++ b/src/amd/compiler/aco_interface.cpp
@@ -244,6 +244,9 @@ aco_compile_shader(const struct aco_compiler_options* options,
    std::vector<uint32_t> code;
    unsigned exec_size = aco::emit_program(program.get(), code);
 
+   if (program->collect_statistics)
+      aco::collect_postasm_stats(program.get(), code);
+
    bool get_disasm = options->dump_shader || options->record_ir;
 
    std::string disasm;
-- 
GitLab

